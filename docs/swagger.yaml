basePath: /
definitions:
  request.CopyAppReq:
    properties:
      app_token:
        description: 需要复制的表格的token
        type: string
      folder_token:
        description: 可以为空，但是要有
        type: string
      name:
        type: string
      time_zone:
        description: '时区,例如: Asia/Shanghai'
        type: string
      without_content:
        description: 是否复制内容
        type: boolean
    required:
    - app_token
    - name
    - time_zone
    type: object
  request.CreateAppReq:
    properties:
      folder_token:
        description: 可以为空，但是要有 多维表格app归属目录
        type: string
      name:
        description: 多维表格app名称
        type: string
    required:
    - name
    type: object
  request.CreateAppTableRecordReq:
    properties:
      contact:
        type: string
      content:
        type: string
      fields:
        additionalProperties: true
        description: 记录的字段 不再校验，required,由后端自动填充
        type: object
      ignore_consistency_check:
        type: boolean
      problem_source:
        type: string
      problem_type:
        type: string
      screen_shot:
        description: 可选字段
        items:
          $ref: '#/definitions/request.ScreenShot'
        type: array
      student_id:
        description: 必填字段
        type: string
    required:
    - contact
    - content
    - student_id
    type: object
  request.GetAppTableRecordReq:
    properties:
      desc:
        description: 是否降序
        type: boolean
      field_names:
        description: 需要查询的字段名
        items:
          type: string
        type: array
      filter_name:
        description: 过滤条件的字段名，根据实际的接口需要，这里只需要设计成一个
        type: string
      filter_val:
        description: 过滤条件的值
        type: string
      pagetoken:
        description: 分页参数,第一次不需要
        type: string
      sort_orders:
        description: 根据什么字段排序
        type: string
    required:
    - field_names
    - filter_name
    - filter_val
    - sort_orders
    type: object
  request.GetPhotoUrlReq:
    properties:
      file_tokens:
        description: 附件token
        items:
          type: string
        type: array
    required:
    - file_tokens
    type: object
  request.InitTokenReq:
    properties:
      access_token:
        type: string
      refresh_token:
        type: string
    required:
    - access_token
    - refresh_token
    type: object
  request.ScreenShot:
    properties:
      file_token:
        type: string
    type: object
  response.Response:
    properties:
      code:
        type: integer
      data: {}
      msg:
        type: string
    type: object
host: localhost:8080
info:
  contact: {}
  title: 木犀反馈系统 API
  version: "1.0"
paths:
  /get_token:
    post:
      consumes:
      - application/json
      description: 获取 token 接口
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回 JWT 令牌
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 获取 token 接口
      tags:
      - Auth
  /init_token:
    post:
      consumes:
      - application/json
      description: 初始化 token 接口
      parameters:
      - description: 初始化请求参数
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.InitTokenReq'
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回初始化结果
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 初始化 token 接口
      tags:
      - Auth
  /sheet/copyapp:
    post:
      consumes:
      - application/json
      description: 基于已有的模板 AppToken 复制创建一个新的多维表格应用
      operationId: copy-app
      parameters:
      - description: Bearer Token
        in: header
        name: Authorization
        required: true
        type: string
      - description: 复制表格请求参数
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.CopyAppReq'
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回复制结果
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误或飞书接口调用失败
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 从模版复制创建多维表格
      tags:
      - Sheet
  /sheet/createapp:
    post:
      consumes:
      - application/json
      description: 基于给定的名称和文件夹 Token 创建一个新的多维表格应用
      operationId: create-app
      parameters:
      - description: Bearer Token
        in: header
        name: Authorization
        required: true
        type: string
      - description: 创建表格请求参数
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.CreateAppReq'
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回创建结果
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误或飞书接口调用失败
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 创建多维表格
      tags:
      - Sheet
  /sheet/createrecord:
    post:
      consumes:
      - application/json
      description: 向指定的多维表格应用中添加记录数据
      operationId: create-app-table-record
      parameters:
      - description: Bearer Token
        in: header
        name: Authorization
        required: true
        type: string
      - description: 新增记录请求参数
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.CreateAppTableRecordReq'
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回创建记录结果
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误或飞书接口调用失败
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 创建多维表格记录
      tags:
      - Sheet
  /sheet/getphotourl:
    post:
      consumes:
      - application/json
      description: 根据文件Token获取截图的临时下载URL，URL有效期为24小时
      operationId: get-photo-url
      parameters:
      - description: Bearer Token
        in: header
        name: Authorization
        required: true
        type: string
      - description: 获取截图URL请求参数
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.GetPhotoUrlReq'
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回临时URL信息
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误或飞书接口调用失败
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 获取截图临时URL
      tags:
      - Sheet
  /sheet/getrecord:
    post:
      consumes:
      - application/json
      description: 根据指定条件查询多维表格中的记录数据
      operationId: get-app-table-record
      parameters:
      - description: Bearer Token
        in: header
        name: Authorization
        required: true
        type: string
      - description: 查询记录请求参数
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.GetAppTableRecordReq'
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回查询结果
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误或飞书接口调用失败
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 获取多维表格记录
      tags:
      - Sheet
swagger: "2.0"
