basePath: /
definitions:
  request.CreatTableRecordReg:
    properties:
      records:
        additionalProperties: {}
        description: 记录列表
        type: object
    required:
    - records
    type: object
  request.GenerateTokenReq:
    properties:
      table_identity:
        description: 反馈表格 Identity，反馈表的唯一标识
        type: string
    required:
    - table_identity
    type: object
  request.LikeReq:
    properties:
      action:
        type: string
      is_like:
        type: integer
      record_id:
        type: string
      user_id:
        type: string
    required:
    - action
    - record_id
    - user_id
    type: object
  response.HealthCheckResponse:
    properties:
      process:
        allOf:
        - $ref: '#/definitions/response.ProcessStats'
        description: Process 当前进程的运行状态
      response_ms:
        description: ResponseMs 响应耗时，单位毫秒
        type: string
      status:
        description: Status 服务状态，例如 "ok"
        type: string
      system:
        allOf:
        - $ref: '#/definitions/response.SystemStats'
        description: System 系统资源使用情况
    type: object
  response.ProcessStats:
    properties:
      cpu_percent:
        description: CPUPercent 进程 CPU 使用率（%）
        type: string
      go_heap_alloc_mb:
        description: GoHeapAllocMB Go 堆分配的内存（MB）
        type: string
      goroutines:
        description: Goroutines 当前运行的 goroutine 数
        type: string
      memory_rss_mb:
        description: MemoryRSSMB 进程常驻内存（MB）
        type: string
    type: object
  response.Response:
    properties:
      code:
        type: integer
      data: {}
      msg:
        type: string
    type: object
  response.SystemStats:
    properties:
      cpu_percent:
        description: CPUPercent CPU 使用率（%）
        type: string
      disk_percent:
        description: DiskPercent 磁盘使用率（%）
        type: string
      disk_total:
        description: DiskTotalGB 磁盘总量（GB）
        type: string
      disk_used:
        description: DiskUsedGB 已使用磁盘（GB）
        type: string
      memory_percent:
        description: MemoryPercent 内存使用率（%）
        type: string
      memory_total:
        description: MemoryTotalMB 内存总量（MB）
        type: string
      memory_used:
        description: MemoryUsedMB 已使用内存（MB）
        type: string
    type: object
host: localhost:8080
info:
  contact: {}
  title: 木犀反馈系统 API
  version: "1.0"
paths:
  /api/v1/auth/table-config/refresh:
    get:
      consumes:
      - application/json
      description: 刷新表格 token 配置接口
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回目前支持索引的表格的公开配置
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 刷新表格 token 配置接口
      tags:
      - Auth
  /api/v1/auth/token:
    post:
      consumes:
      - application/json
      description: 获取 token 接口
      parameters:
      - description: 获取Token请求参数
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.GenerateTokenReq'
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回 JWT 令牌
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 获取 token 接口
      tags:
      - Auth
  /api/v1/health:
    get:
      consumes:
      - application/json
      description: 健康检查，返回当前服务占用的资源等信息
      operationId: health-check
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回健康检查结果
          schema:
            allOf:
            - $ref: '#/definitions/response.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.HealthCheckResponse'
              type: object
        "500":
          description: 服务器内部错误
          schema:
            allOf:
            - $ref: '#/definitions/response.Response'
            - properties:
                data:
                  type: string
              type: object
      summary: 健康检查，返回当前服务占用的资源等信息
  /api/v1/sheet/photos/url:
    get:
      consumes:
      - application/json
      description: 根据文件Token获取截图的临时下载URL，URL有效期为24小时
      operationId: get-photo-url
      parameters:
      - description: Bearer Token
        in: header
        name: Authorization
        required: true
        type: string
      - collectionFormat: csv
        description: 附件 token
        in: query
        items:
          type: string
        name: file_tokens
        required: true
        type: array
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回临时URL信息
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误或飞书接口调用失败
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 获取截图临时URL
      tags:
      - Sheet
  /api/v1/sheet/records:
    get:
      consumes:
      - application/json
      description: 根据指定条件查询多维表格中的记录数据
      operationId: get-table-record
      parameters:
      - description: Bearer Token
        in: header
        name: Authorization
        required: true
        type: string
      - description: 用于查询记录的关键值，一般使用学号的字段名
        in: query
        name: key_field
        required: true
        type: string
      - description: 用于查询记录的关键值，一般使用学号的字段值
        in: query
        name: key_value
        required: true
        type: string
      - description: 分页参数,第一次不需要
        in: query
        name: page_token
        required: true
        type: string
      - collectionFormat: csv
        description: 需要查询的字段名
        in: query
        items:
          type: string
        name: record_names
        required: true
        type: array
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回查询结果
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误或飞书接口调用失败
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 获取多维表格记录
      tags:
      - Sheet
    post:
      consumes:
      - application/json
      description: 向指定的多维表格应用中添加记录数据
      operationId: create-table-record
      parameters:
      - description: Bearer Token
        in: header
        name: Authorization
        required: true
        type: string
      - description: 新增记录请求参数
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.CreatTableRecordReg'
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回创建记录结果
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误或飞书接口调用失败
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 创建多维表格记录
      tags:
      - Sheet
  /api/v1/sheet/records/normal:
    get:
      consumes:
      - application/json
      description: 根据指定条件查询多维表格中的记录数据
      operationId: get-app-table-normal-problem-record
      parameters:
      - description: Bearer Token
        in: header
        name: Authorization
        required: true
        type: string
      - collectionFormat: csv
        description: 需要查询的字段名
        in: query
        items:
          type: string
        name: record_names
        required: true
        type: array
      produces:
      - application/json
      responses:
        "200":
          description: 成功返回查询结果
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 请求参数错误或飞书接口调用失败
          schema:
            $ref: '#/definitions/response.Response'
        "500":
          description: 服务器内部错误
          schema:
            $ref: '#/definitions/response.Response'
      summary: 获取常见问题记录
      tags:
      - Sheet
  /like/addtask:
    post:
      consumes:
      - application/json
      description: 添加一个点赞或取消点赞的任务
      parameters:
      - description: 点赞请求参数
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.LikeReq'
      produces:
      - application/json
      responses:
        "200":
          description: 添加点赞任务成功
          schema:
            $ref: '#/definitions/response.Response'
        "400":
          description: 添加点赞任务失败
          schema:
            $ref: '#/definitions/response.Response'
      summary: 添加点赞任务
      tags:
      - 点赞
swagger: "2.0"
